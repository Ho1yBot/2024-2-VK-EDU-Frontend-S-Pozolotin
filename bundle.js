!function(e){var t={};function n(a){if(t[a])return t[a].exports;var c=t[a]={i:a,l:!1,exports:{}};return e[a].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)n.d(a,c,function(t){return e[t]}.bind(null,c));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function a(e,t){var n=JSON.parse(localStorage.getItem("messages_".concat(e)))||[];n.push(t),localStorage.setItem("messages_".concat(e),JSON.stringify(n))}function c(e){return JSON.parse(localStorage.getItem("messages_".concat(e)))||[]}function o(){localStorage.clear()}function r(e){e.preventDefault();var t=document.querySelector(".form-input"),n=t.value.trim();if(n){var c={text:n,sender:"Вы",time:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},o=localStorage.getItem("currentChat");a(o,c),s(c),function(e,t){var n=document.querySelector('.chat-item[data-chat-id="'.concat(e,'"]'));if(n){var a=n.querySelector(".chat-info p"),c=n.querySelector(".chat-time span");a&&c?(a.textContent=t.text,c.textContent=t.time):console.error("Unable to find elements for last message or time within the chat button.")}else console.error("Chat button not found for chat ID:",e)}(o,c),t.value="";var r=document.querySelector(".chat-window");r&&(r.scrollTop=r.scrollHeight)}}function i(e){var t=document.querySelector("form");"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t.dispatchEvent(new Event("submit")))}function s(e){var t=document.querySelector(".messages-container"),n=document.createElement("div");n.classList.add("message-container");var a=document.createElement("div");a.classList.add("message-sender"),a.textContent=e.sender||"Вы";var c=document.createElement("div");c.classList.add("message-time"),c.textContent=e.time;var o=document.createElement("div");if(o.classList.add("message-content"),e.isImage){var r=document.createElement("img");r.src=e.content,r.alt=e.name,r.classList.add("message-image"),o.appendChild(r)}else if(e.content&&e.type){var i=document.createElement("a");i.href=e.content,i.textContent=e.name,i.download=e.name,o.appendChild(i)}else o.textContent=e.text||"";n.appendChild(a),n.appendChild(o),n.appendChild(c),t.appendChild(n),t.scrollTop=t.scrollHeight}var l=document.createElement("input");function d(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(){var e=localStorage.getItem("currentChat"),c={name:t.name,content:n.result,type:t.type,time:(new Date).toLocaleTimeString(),isImage:t.type.startsWith("image/")};a(e,c),s(c),l.value=""},n.readAsDataURL(t)}}l.type="file",l.style.display="none";var u,m=document.getElementById("header-component"),g=document.getElementById("chat-list-component"),v=document.getElementById("floating-button-component");function f(){c().forEach(s)}m.appendChild(function(){var e=document.createElement("div");e.classList.add("header","center"),e.innerHTML='<button class="header_burger-menu"><img src="./static/images/burger-menu.svg" alt="Кнопка меню"></button>\n        <button class="header_title">\n            <div class="header_title-text">Messanger</div>\n        </button>\n        <nav class="header_nav">\n            <button class="header_search"><img src="./static/images/search-icon.svg" alt="Search"></button>\n            <button id="menu-button" style="display: none;"><img src="./static/images/menu-dots.svg" alt="Меню"></button>\n            <div id="menu-container" class="menu-container hidden"> \n                <ul class="menu_list">\n                    <li class="menu_item"><button>Info</button></li>\n                    <li class="menu_item"><button>Mute</button></li>\n                    <li class="menu_item"><button id="clear-local-storage">Clear messages</button></li>\n                </ul>\n            </div>\n        </nav>';var t=e.querySelector("#menu-button"),n=e.querySelector("#menu-container"),a=e.querySelector("#clear-local-storage");return t.addEventListener("click",(function(){n.classList.toggle("hidden")})),document.addEventListener("click",(function(e){t.contains(e.target)||n.contains(e.target)||n.classList.add("hidden")})),a.addEventListener("click",(function(){var e;o(),(e=document.querySelector(".messages-container"))&&(e.innerHTML=""),n.classList.add("hidden")})),e}()),g.appendChild(function(){l.addEventListener("change",d);var e=document.createElement("div");function t(){var e=document.querySelector(".chat-window"),t=document.querySelector(".form");e&&e.remove(),t&&t.remove(),document.getElementById("chat-list-component").style.display="flex",document.querySelector(".header_title-text").textContent="Messenger",document.getElementById("menu-button").style.display="none";var n=document.getElementById("floating-button-component");n&&(n.style.display="block")}return e.classList.add("chat-container"),[{id:1,avatar:"./static/images/user-icon.svg",title:"Чат с Андреем",lastMessage:"Последнее сообщение...",time:"14:23",isRead:!0}].forEach((function(n){var a=document.createElement("button");a.classList.add("chat-item"),a.setAttribute("data-chat-id",n.id);var o=c(n.id),d=o.length>0?o[o.length-1]:{text:"Нет сообщений",time:""};a.innerHTML='\n        <div class="chat-info-wrp">\n            <img src="'.concat(n.avatar,'" alt="Аватарка">\n            <div class="chat-info">\n                <h3>').concat(n.title,"</h3>\n                <p>").concat(d.text,'</p> \n            </div>\n        </div>\n        <div class="chat-time">\n            <span>').concat(d.time||"","</span> \n            ").concat(n.isRead?'<span class="read-status">✓✓</span>':"","\n        </div>"),a.addEventListener("click",(function(){return function(e,n){(function(e){localStorage.setItem("currentChat",e)})(e),document.getElementById("chat-list-component").style.display="none",document.getElementById("menu-button").style.display="block";var a=document.createElement("div");a.classList.add("chat-window","center"),a.innerHTML='\n            <div class="chat-header">\n                <button class="back-button"><img src="./static/images/arrow-back.svg" alt="Вернуться к списку чатов"></button>\n            </div>\n            <div class="messages-container"></div>\n        ',document.getElementById("header-component").insertAdjacentElement("afterend",a);var o=document.createElement("form");o.classList.add("form","center"),o.innerHTML='\n            <textarea class="form-input" name="message-text" placeholder="Введите сообщение" type="text"></textarea>\n            <button class="attach"><img src="./static/images/attach-file-icon.svg" alt="Добавление файла"></button>\n            <button type="submit"><img src="./static/images/send-icon.svg" alt="Отправка сообщения"></button>\n        ',o.addEventListener("submit",(function(e){e.preventDefault(),r(e)})),o.addEventListener("keypress",i),o.querySelector(".attach").addEventListener("click",(function(){l.click()})),a.insertAdjacentElement("afterend",o),o.addEventListener("submit",r),o.addEventListener("keypress",i),a.querySelector(".back-button").addEventListener("click",t),function(e){var t=c(e),n=document.querySelector(".messages-container");t.forEach((function(e){return s(e)})),document.querySelector(".chat-window").scrollTop=n.scrollHeight}(e);var d=document.getElementById("floating-button-component");d&&(d.style.display="none")}(n.id,n.title)})),e.appendChild(a)})),e}()),v.appendChild(((u=document.createElement("button")).classList.add("floating-button"),u.innerHTML='<img src="./static/images/create-chat.svg" alt="Создать чат">',u.onclick=function(){},u)),document.addEventListener("DOMContentLoaded",(function(){f();var e=document.querySelector("form"),t=document.querySelector(".form-input");e&&t?(e.addEventListener("submit",r),e.addEventListener("keypress",i)):console.error("Форма или поле ввода не найдены.")}))}]);