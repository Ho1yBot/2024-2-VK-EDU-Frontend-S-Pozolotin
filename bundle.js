!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function a(e,t){var n=JSON.parse(localStorage.getItem("messages_".concat(e)))||[];n.push(t);try{localStorage.setItem("messages_".concat(e),JSON.stringify(n))}catch(e){"QuotaExceededError"===e.name&&(console.error("LocalStorage quota exceeded"),alert("Превышен лимит на хранение данных. Удалите старые сообщения или файлы."))}}function r(e){return JSON.parse(localStorage.getItem("messages_".concat(e)))||[]}var o=document.createElement("input");function i(e){var t=document.querySelector("form");"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t.dispatchEvent(new Event("submit")))}function c(e,t){var n=document.createElement("div");n.classList.add("message-container");var a=document.createElement("div");a.classList.add("message-sender"),a.textContent=e.sender;var r=document.createElement("div");r.classList.add("message-text"),r.textContent=e.text;var o=document.createElement("div");o.classList.add("message-time"),o.textContent=e.time,n.appendChild(a),n.appendChild(r),n.appendChild(o),t.appendChild(n),t.scrollTop=t.scrollHeight}o.type="file",o.style.display="none";var l,s=document.getElementById("header-component"),u=document.getElementById("chat-list-component"),d=document.getElementById("floating-button-component");s.appendChild(function(){var e=document.createElement("div");e.classList.add("header","center"),e.innerHTML='<button class="header_burger-menu"><img src="./static/images/burger-menu.svg" alt="Кнопка меню"></button>\n        <button class="header_title">\n            <div class="header_title-text">Messanger</div>\n        </button>\n        <nav class="header_nav">\n            <button class="header_search"><img src="./static/images/search-icon.svg" alt="Search"></button>\n            <button id="menu-button" style="display: none;"><img src="./static/images/menu-dots.svg" alt="Меню"></button>\n            <div id="menu-container" class="menu-container hidden"> \n                <ul class="menu_list">\n                    <li class="menu_item"><button>Info</button></li>\n                    <li class="menu_item"><button>Mute</button></li>\n                    <li class="menu_item"><button id="clear-local-storage">Clear messages</button></li>\n                </ul>\n            </div>\n        </nav>';var t=e.querySelector("#menu-button"),n=e.querySelector("#menu-container");return t.addEventListener("click",(function(){n.classList.toggle("hidden")})),document.addEventListener("click",(function(e){t.contains(e.target)||n.contains(e.target)||n.classList.add("hidden")})),e}()),u.appendChild(function(){var e=document.createElement("div");e.classList.add("chat-container");var t=null;function n(){document.querySelector(".chat-window").remove(),document.getElementById("chat-list-component").style.display="flex",document.querySelector(".header_title-text").textContent="Messenger",document.getElementById("menu-button").style.display="none";var e=document.getElementById("floating-button-component");e&&(e.style.display="block")}return[{id:1,avatar:"./static/images/user-icon.svg",title:"Чат с Андреем",lastMessage:"Последнее сообщение...",time:"14:23",isRead:!0}].forEach((function(o){var l=document.createElement("button");l.classList.add("chat-item");var s=r(o.id),u=s.length>0?s[s.length-1]:{text:"Нет сообщений",time:""};l.innerHTML='\n        <div class="chat-info-wrp">\n            <img src="'.concat(o.avatar,'" alt="Аватарка">\n            <div class="chat-info">\n                <h3>').concat(o.title,"</h3>\n                <p>").concat(u.text,'</p> \n            </div>\n        </div>\n        <div class="chat-time">\n            <span>').concat(u.time||"","</span> \n            ").concat(o.isRead?'<span class="read-status">✓✓</span>':"","\n        </div>"),l.addEventListener("click",(function(){return function(e,o){!function(e){localStorage.setItem("currentChat",e)}(e);var l=document.getElementById("floating-button-component");l&&(l.style.display="none");document.getElementById("chat-list-component").style.display="none",document.getElementById("menu-button").style.display="block";var s=document.createElement("div");s.classList.add("chat-window","center"),s.innerHTML='\n            <div class="chat-header">\n                <button class="back-button"><img src="./static/images/arrow-back.svg" alt="Вернуться к списку чатов"></button>\n            </div>\n            <div class="messages-container"></div>\n        \n            <form class="form" action="/">\n                <textarea class="form-input" name="message-text" placeholder="Введите сообщение" type="text"></textarea>\n                <button class="attach"><img src="./static/images/attach-file-icon.svg" alt="Добавление файла"></button>\n                <button type="submit"><img src="./static/images/send-icon.svg" alt="Отправка сообщения"></button>\n                <div class="attached-file-info" style="display: none;"></div> \x3c!-- Для отображения прикрепленного файла --\x3e\n                <input type="file" id="file-input" style="display: none;" /> \x3c!-- Поле для выбора файла --\x3e\n            </form>',document.querySelector(".header_title-text").textContent=o,document.getElementById("header-component").insertAdjacentElement("afterend",s),s.querySelector(".back-button").addEventListener("click",n),function(e){var t=r(e),n=document.querySelector(".messages-container");t.forEach((function(e){return c(e,n)})),n.scrollTop=n.scrollHeight}(e);var u=s.querySelector("form"),d=s.querySelector("#file-input"),m=s.querySelector(".attach"),v=s.querySelector(".attached-file-info");m.addEventListener("click",(function(e){e.preventDefault(),d.click()})),d.addEventListener("change",(function(e){if((t=e.target.files[0])&&t.size>5e6)return alert("Файл слишком большой для загрузки. Должен быть меньше 5 МБ"),void(t=null);t&&(v.textContent="Файл: ".concat(t.name," прикреплен"),v.style.display="block",v.style.position="absolute",v.style.bottom="48px")})),u.addEventListener("submit",(function(n){n.preventDefault();var r=u.querySelector("textarea").value.trim(),o=document.querySelector(".messages-container");if(r||t)if(t){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){var n={text:r||"",time:(new Date).toLocaleTimeString(),file:i.result};a(e,n),c(n,o),u.querySelector("textarea").value="",t=null,v.style.display="none"}}else{var l={text:r||"",time:(new Date).toLocaleTimeString(),file:null};a(e,l),c(l,o),u.querySelector("textarea").value=""}})),u.addEventListener("keypress",i),document.getElementById("clear-local-storage").addEventListener("click",(function(){var e=localStorage.getItem("currentChat");e&&(localStorage.removeItem("messages_".concat(e)),document.querySelector(".messages-container").innerHTML="")}))}(o.id,o.title)})),e.appendChild(l)})),e}()),d.appendChild(((l=document.createElement("button")).classList.add("floating-button"),l.innerHTML='<img src="./static/images/create-chat.svg" alt="Создать чат">',l.onclick=function(){},l)),r();var m=document.querySelector("form");document.querySelector(".form-input");m.addEventListener("submit",(function(e){e.preventDefault();var t=document.querySelector(".form-input"),n=t.value.trim(),r=document.querySelector(".file-input"),o=r.files[0];if(n||o){var i=localStorage.getItem("currentChat");if(o){var l=new FileReader;l.readAsDataURL(o),l.onload=function(){var e={text:n||"",sender:"Вы",time:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),file:l.result};a(i,e),c(e),t.value="",r.value=""}}else{var s={text:n,sender:"Вы",time:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),file:null};a(i,s),c(s),t.value=""}}})),m.addEventListener("keypress",i)}]);