!function(e){var t={};function n(a){if(t[a])return t[a].exports;var c=t[a]={i:a,l:!1,exports:{}};return e[a].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)n.d(a,c,function(t){return e[t]}.bind(null,c));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function a(e){return JSON.parse(localStorage.getItem("messages_".concat(e)))||[]}function c(e){localStorage.removeItem("messages_".concat(e)),document.querySelector('[data-currentChat="'.concat(e,'"]')).textContent="Нет сообщений"}function o(e){e.preventDefault();var t=document.querySelector(".form-input"),n=t.value.trim();if(n){var a={text:n,sender:"Вы",time:(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},c=localStorage.getItem("currentChat");!function(e,t){var n=JSON.parse(localStorage.getItem("messages_".concat(e)))||[];n.push(t),localStorage.setItem("messages_".concat(e),JSON.stringify(n))}(c,a),s(a),r(c,a),t.value="";var o=document.querySelector(".chat-window");o&&(o.scrollTop=o.scrollHeight)}}function r(e,t){var n=document.querySelector('.chat-item[data-chat-id="'.concat(e,'"]'));if(n){var a=n.querySelector(".chat-info div"),c=n.querySelector(".chat-time span");a&&c&&(t?(t.isImage||t.content&&t.type?a.textContent="".concat(t.name):t.text?a.textContent=t.text:a.textContent="Нет сообщений",c.textContent=t.time||""):(a.textContent="Нет сообщений",c.textContent=""))}}function i(e){var t=document.querySelector("form");"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t.dispatchEvent(new Event("submit")))}function s(e){var t=document.querySelector(".messages-container"),n=document.createElement("div");n.classList.add("message-container");var a=document.createElement("div");a.classList.add("message-sender"),a.textContent=e.sender||"Вы";var c=document.createElement("div");c.classList.add("message-time"),c.textContent=e.time;var o=document.createElement("div");if(o.classList.add("message-content"),e.isImage){var r=document.createElement("img");r.src=e.content,r.alt=e.name,r.classList.add("message-image"),o.appendChild(r)}else if(e.content&&e.type){var i=document.createElement("a");i.href=e.content,i.textContent=e.name,i.download=e.name,o.appendChild(i)}else o.textContent=e.text||"";n.appendChild(a),n.appendChild(o),n.appendChild(c),t.appendChild(n),t.scrollTop=t.scrollHeight}var l=document.createElement("input");function d(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(){var e=u(),a={name:t.name,content:n.result,type:t.type,time:(new Date).toLocaleTimeString(),isImage:t.type.startsWith("image/")},c=JSON.parse(localStorage.getItem("messages_".concat(e)))||[];c.push(a),localStorage.setItem("messages_".concat(e),JSON.stringify(c)),s(c[c.length-1]),r(e,a)},n.readAsDataURL(t)}}function u(){return localStorage.getItem("currentChat")}l.type="file",l.style.display="none";var m,g=document.getElementById("header-component"),v=document.getElementById("chat-list-component"),f=document.getElementById("floating-button-component");function p(){a().forEach(s)}g.appendChild(function(){var e=document.createElement("div");e.classList.add("header","center"),e.innerHTML='<button class="header_burger-menu"><img src="./static/images/burger-menu.svg" alt="Кнопка меню"></button>\n        <button class="header_title">\n            <div class="header_title-text">Messanger</div>\n        </button>\n        <nav class="header_nav">\n            <button class="header_search"><img src="./static/images/search-icon.svg" alt="Search"></button>\n            <button id="menu-button" style="display: none;"><img src="./static/images/menu-dots.svg" alt="Меню"></button>\n            <div id="menu-container" class="menu-container hidden"> \n                <ul class="menu_list">\n                    <li class="menu_item"><button>Info</button></li>\n                    <li class="menu_item"><button>Mute</button></li>\n                    <li class="menu_item"><button id="clear-local-storage">Clear messages</button></li>\n                </ul>\n            </div>\n        </nav>';var t=e.querySelector("#menu-button"),n=e.querySelector("#menu-container"),a=e.querySelector("#clear-local-storage");return t.addEventListener("click",(function(){n.classList.toggle("hidden")})),document.addEventListener("click",(function(e){t.contains(e.target)||n.contains(e.target)||n.classList.add("hidden")})),a.addEventListener("click",(function(){var e;c(u()),(e=document.querySelector(".messages-container"))&&(e.innerHTML=""),n.classList.add("hidden")})),e}()),v.appendChild(function(){l.addEventListener("change",d);var e=document.createElement("div");function t(){var e=document.querySelector(".chat-window"),t=document.querySelector(".form");e&&e.remove(),t&&t.remove(),document.getElementById("chat-list-component").style.display="flex",document.querySelector(".header_title-text").textContent="Messenger",document.getElementById("menu-button").style.display="none";var n=document.getElementById("floating-button-component");n&&(n.style.display="block")}return e.classList.add("chat-container"),[{id:1,avatar:"./static/images/user-icon.svg",title:"Чат с Андреем",lastMessage:"",time:"14:23",isRead:!0},{id:2,avatar:"./static/images/user-icon.svg",title:"Чат с Max",lastMessage:"",time:"14:23",isRead:!0},{id:3,avatar:"./static/images/user-icon.svg",title:"Чат с Андреем",lastMessage:"",time:"14:23",isRead:!0}].forEach((function(n){var c=document.createElement("button");c.classList.add("chat-item"),c.setAttribute("data-chat-id",n.id);var r=a(n.id),d=r.length>0?r[r.length-1]:{text:"Нет сообщений",time:""};c.innerHTML='\n        <div class="chat-info-wrp">\n            <img src="'.concat(n.avatar,'" alt="Аватарка">\n            <div class="chat-info">\n                <h3>').concat(n.title,"</h3>\n                <div data-currentChat=").concat(n.id,">").concat(d.name||d.text,'</div> \n            </div>\n        </div>\n        <div class="chat-time">\n            <span>').concat(d.time||"","</span> \n            ").concat(n.isRead?'<span class="read-status">✓✓</span>':"","\n        </div>"),c.addEventListener("click",(function(){return function(e,n){(function(e){localStorage.setItem("currentChat",e)})(e),document.getElementById("chat-list-component").style.display="none",document.getElementById("menu-button").style.display="block";var c=document.createElement("div");c.classList.add("chat-window","center"),c.innerHTML='\n            <div class="chat-header">\n                <button class="back-button"><img src="./static/images/arrow-back.svg" alt="Вернуться к списку чатов"></button>\n            </div>\n            <div class="messages-container"></div>\n        ',document.getElementById("header-component").insertAdjacentElement("afterend",c);var r=document.createElement("form");r.classList.add("form","center"),r.innerHTML='\n            <textarea class="form-input" name="message-text" placeholder="Введите сообщение" type="text"></textarea>\n            <button class="attach"><img src="./static/images/attach-file-icon.svg" alt="Добавление файла"></button>\n            <button type="submit"><img src="./static/images/send-icon.svg" alt="Отправка сообщения"></button>\n        ';var d=c.querySelector(".clear-button");d&&d.addEventListener("click",(function(){clearMessages(e)}));r.addEventListener("submit",(function(e){e.preventDefault(),o(e)})),r.addEventListener("keypress",i),r.querySelector(".attach").addEventListener("click",(function(){l.click()})),c.insertAdjacentElement("afterend",r),r.addEventListener("submit",o),r.addEventListener("keypress",i),c.querySelector(".back-button").addEventListener("click",t),function(e){var t=a(e),n=document.querySelector(".messages-container");t.forEach((function(e){return s(e)})),document.querySelector(".chat-window").scrollTop=n.scrollHeight}(e);var u=document.getElementById("floating-button-component");u&&(u.style.display="none")}(n.id,n.title)})),e.appendChild(c)})),e}()),f.appendChild(((m=document.createElement("button")).classList.add("floating-button"),m.innerHTML='<img src="./static/images/create-chat.svg" alt="Создать чат">',m.onclick=function(){},m)),document.addEventListener("DOMContentLoaded",(function(){p();var e=document.querySelector("form"),t=document.querySelector(".form-input");e&&t&&(e.addEventListener("submit",o),e.addEventListener("keypress",i))}))}]);